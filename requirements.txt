# conda create -n asr python=3.11 --y
# conda activate asr
conda install --channel conda-forge ffmpeg --y
conda install ipython --y

# cuda 13.x requires driver >= 580
# pip3 install torch torchvision --index-url https://download.pytorch.org/whl/cu130
# cuda 12.x requires driver >= 525
pip3 install torch torchvision
# pip3 install torch torchvision torchaudio
# cuda 11.x requires driver >= 450
# pip3 install torch==2.6.0 torchvision==0.21.0 torchaudio==2.6.0 --index-url https://download.pytorch.org/whl/cu118

# pip3 install transformers datasets[audio] evaluate tqdm pyyaml wandb jiwer==3.1.0 iso639-lang PyYAML accelerate bert-score pypinyin OpenCC==1.1.0 WeTextNormalizer==1.00 cn2an
pip3 install transformers datasets[audio] evaluate tqdm pyyaml wandb jiwer==3.1.0 iso639-lang PyYAML accelerate bert-score pypinyin OpenCC==1.1.0 omegaconf taibun ToJyutping


# chinese related
# some normalizers use OpenCC
# pip3 install OpenCC==1.1.0 pypinyin
# pip3 install cn2an WeTextProcessing==1.00
# ultraeval-audio also uses zhconv for cantonese (yue)
# for cantonese may use 
# pip3 install ToJyutping

# recent version of datasets requires pyarrow > 21 which requires glib > 2.28
# however most of our servers have version 2.27 or older glib
# alternative is to install datasets==4.0 which has lower pyarrow version req (>15)
# but audio still requires torch >=2.7.0 (more than cuda 11.x supports)
# another is datasets==3.6.0 which does not require a specific pytorch version
# pip3 install pyarrow --only-binary=:all:
# pip3 install transformers datasets[audio]==3.6.0 evaluate tqdm pyyaml wandb==0.23.0 jiwer==3.1.0

# required for voxtral
# needed if compiling on glibc < 2.28
# pip3 install tiktoken==0.11.0
# pip3 install "mistral-common[audio,hf-hub]"

# others (i think its auto-installed when installing mistral-common[audio])
# pip3 install soundfile

# when using quantization (and in general if using auto device_map)
# pip3 install accelerate
# pip3 install bitsandbytes

# when using quantization some packages may ask for cuda even if pytorch works
# need to use conda to install toolkit independently
# version should match pytorch version used
# this doesnt work, but maybe if used before installatin of
# conda install -c nvidia cuda-toolkit=13.0 cuda-nvcc=13.0 --y

# other quant types
# pip3 install hqq
# pip3 install optimum-quanto
# pip3 install torchao
# pip3 install fbgemm-gpu-genai

# when using granite need
# pip3 install torchaudio peft
# pip3 install torchaudio==2.9.1 --index-url https://download.pytorch.org/whl/cu130

# for audio-flamingo
# need to clone transformers and install locally or transformers>5

# for phi4
# pip3 install backoff scipy
# pip3 install flash-attn --no-build-isolation
